<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Velora</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
  body { font-family: 'Inter', sans-serif; }
  .tab-content { display: none; }
  .tab-active { display: block; }
  .btn { transition: 0.2s; cursor: pointer; }
  .btn:hover { transform: scale(1.05); }
</style>
</head>

<body class="bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 min-h-screen flex items-center justify-center p-6">

<!-- LOGIN / REGISTER SCREEN -->
<div id="auth-screen" class="bg-white rounded-3xl shadow-2xl p-10 max-w-md w-full text-center">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Velora</h1>

    <div class="flex justify-center gap-4 mb-6">
        <button id="show-login" class="px-4 py-2 bg-purple-600 text-white rounded-xl btn">Giriş</button>
        <button id="show-register" class="px-4 py-2 bg-indigo-600 text-white rounded-xl btn">Kayıt Ol</button>
    </div>

    <!-- LOGIN FORM -->
    <div id="login-form">
        <input id="login-email" type="email" placeholder="E-posta" class="w-full p-3 rounded-xl border mb-3">
        <input id="login-password" type="password" placeholder="Şifre" class="w-full p-3 rounded-xl border mb-5">
        <button id="login-btn" class="w-full py-3 bg-indigo-600 text-white rounded-xl btn">Giriş Yap</button>
    </div>

    <!-- REGISTER FORM -->
    <div id="register-form" class="hidden">
        <input id="reg-name" type="text" placeholder="Ad Soyad" class="w-full p-3 rounded-xl border mb-3">
        <input id="reg-email" type="email" placeholder="E-posta" class="w-full p-3 rounded-xl border mb-3">
        <input id="reg-password" type="password" placeholder="Şifre" class="w-full p-3 rounded-xl border mb-5">
        <button id="register-btn" class="w-full py-3 bg-purple-600 text-white rounded-xl btn">Kayıt Ol</button>
    </div>
</div>

<!-- MAIN APP -->
<div id="app-screen" class="hidden bg-white/10 backdrop-blur-md border border-white/20 rounded-3xl shadow-2xl w-full max-w-4xl p-6">

    <div class="flex justify-between mb-6">
        <h1 class="text-3xl text-white font-bold">Velora</h1>
        <button id="logout-btn" class="px-4 py-2 bg-red-600 text-white rounded-xl btn">Çıkış</button>
    </div>

    <!-- Tabs -->
    <div class="flex gap-3 mb-6">
        <button class="tab-button px-4 py-2 bg-indigo-500 text-white rounded-xl btn" data-tab="tasks">Görevler</button>
        <button class="tab-button px-4 py-2 bg-purple-500 text-white rounded-xl btn" data-tab="passwords">Kasa</button>
        <button class="tab-button px-4 py-2 bg-orange-500 text-white rounded-xl btn" data-tab="reminders">Hatırlatıcılar</button>
    </div>

    <!-- CONTENT -->
    <div id="tasks" class="tab-content tab-active">
        <h2 class="text-xl font-bold text-white mb-4">Görev Ekle</h2>
        <input id="task-title" placeholder="Görev başlığı" class="w-full p-3 rounded-xl mb-2">
        <textarea id="task-desc" placeholder="Açıklama" class="w-full p-3 rounded-xl mb-3"></textarea>
        <button id="add-task" class="px-4 py-3 bg-indigo-600 text-white rounded-xl btn mb-4">Ekle</button>
        <div id="task-list" class="space-y-3"></div>
    </div>

    <div id="passwords" class="tab-content">
        <h2 class="text-xl font-bold text-white mb-4">Şifre Kaydet</h2>
        <input id="pwd-account" placeholder="Hesap (Örn: Instagram)" class="w-full p-3 rounded-xl mb-2">
        <input id="pwd-user" placeholder="Kullanıcı Adı" class="w-full p-3 rounded-xl mb-2">
        <input id="pwd-pass" placeholder="Şifre" class="w-full p-3 rounded-xl mb-3">
        <button id="add-password" class="px-4 py-3 bg-purple-600 text-white rounded-xl btn mb-4">Kasa’ya Ekle</button>
        <div id="password-list" class="space-y-3"></div>
    </div>

    <div id="reminders" class="tab-content">
        <h2 class="text-xl font-bold text-white mb-4">Hatırlatıcı Ekle</h2>
        <input id="rem-note" placeholder="Hatırlatma Notu" class="w-full p-3 rounded-xl mb-2">
        <input id="rem-time" type="time" class="w-full p-3 rounded-xl mb-3">
        <button id="add-reminder" class="px-4 py-3 bg-orange-600 text-white rounded-xl btn mb-4">Ekle</button>
        <div id="reminder-list" class="space-y-3"></div>
    </div>
</div>

<script>
const API = "http://127.0.0.1:8000";
let USER_ID = null;

/* TAB SİSTEMİ */
document.querySelectorAll(".tab-button").forEach(btn => {
    btn.addEventListener("click", () => {
        document.querySelectorAll(".tab-content").forEach(c => c.classList.remove("tab-active"));
        document.getElementById(btn.dataset.tab).classList.add("tab-active");
    });
});

/* FORM GEÇİŞLERİ */
document.getElementById("show-login").onclick = () => {
    document.getElementById("login-form").classList.remove("hidden");
    document.getElementById("register-form").classList.add("hidden");
};
document.getElementById("show-register").onclick = () => {
    document.getElementById("register-form").classList.remove("hidden");
    document.getElementById("login-form").classList.add("hidden");
};

/* KAYIT */
document.getElementById("register-btn").onclick = async () => {
    const full_name = document.getElementById("reg-name").value;
    const email = document.getElementById("reg-email").value;
    const password = document.getElementById("reg-password").value;

    const r = await fetch(API + "/auth/register", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ full_name, email, password })
    });

    alert("Kayıt başarılı! Şimdi giriş yap.");
};

/* GİRİŞ */
document.getElementById("login-btn").onclick = async () => {
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;

    const r = await fetch(API + "/auth/login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, password })
    });

    const data = await r.json();

    USER_ID = data.user_id;
    document.getElementById("auth-screen").classList.add("hidden");
    document.getElementById("app-screen").classList.remove("hidden");

    loadTasks();
    loadPasswords();
    loadReminders();
};

/* ÇIKIŞ */
document.getElementById("logout-btn").onclick = () => location.reload();

/* GÖREV EKLE */
document.getElementById("add-task").onclick = async () => {
    const title = document.getElementById("task-title").value;
    const description = document.getElementById("task-desc").value;

    await fetch(API + `/api/tasks/${USER_ID}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ title, description })
    });

    loadTasks();
};

/* GÖREVLERİ YÜKLE */
async function loadTasks() {
    const r = await fetch(API + `/api/tasks/${USER_ID}`);
    const list = await r.json();

    const box = document.getElementById("task-list");
    box.innerHTML = "";

    list.forEach(item => {
        box.innerHTML += `
            <div class="p-4 bg-white rounded-xl shadow border">
                <h3 class="font-bold">${item.title}</h3>
                <p>${item.description || ""}</p>
            </div>`;
    });
}

/* ŞİFRE EKLE */
document.getElementById("add-password").onclick = async () => {
    const account = document.getElementById("pwd-account").value;
    const username = document.getElementById("pwd-user").value;
    const password = document.getElementById("pwd-pass").value;

    await fetch(API + `/api/passwords/${USER_ID}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ account, username, password })
    });

    loadPasswords();
};

/* ŞİFRELERİ YÜKLE */
async function loadPasswords() {
    const r = await fetch(API + `/api/passwords/${USER_ID}`);
    const list = await r.json();

    const box = document.getElementById("password-list");
    box.innerHTML = "";

    list.forEach(item => {
        box.innerHTML += `
            <div class="p-4 bg-white rounded-xl shadow border">
                <h3 class="font-bold">${item.account}</h3>
                <p>${item.username}</p>
                <p class="text-sm text-gray-600">Güç: ${item.strength}</p>
            </div>`;
    });
}

/* HATIRLATICI EKLE */
document.getElementById("add-reminder").onclick = async () => {
    const note = document.getElementById("rem-note").value;
    const time = document.getElementById("rem-time").value;

    await fetch(API + `/api/reminders/${USER_ID}`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ note, time })
    });

    loadReminders();
};

/* HATIRLATICILARI YÜKLE */
async function loadReminders() {
    const r = await fetch(API + `/api/reminders/${USER_ID}`);
    const list = await r.json();

    const box = document.getElementById("reminder-list");
    box.innerHTML = "";

    list.forEach(item => {
        box.innerHTML += `
            <div class="p-4 bg-white rounded-xl shadow border">
                <h3 class="font-bold">${item.note}</h3>
                <p>${item.time}</p>
            </div>`;
    });
}
</script>

</body>
</html>
